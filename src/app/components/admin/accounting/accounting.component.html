<div class="flex items-center justify-between px-6 py-3 bg-white border-b">
  <div class="flex items-center">
    <h1 class="text-xl font-semibold text-gray-800">Accounting Management</h1>
  </div>
</div>
<!-- Tabs -->
<div class="bg-white border-b">
  <div class="px-6 flex">
    <button class="tab-button px-4 py-3 text-sm active font-medium text-primary" (click)="showTab('fees')"
      id="fees">Fees</button>
    <button class="tab-button px-4 py-3 text-sm text-gray-500" (click)="showTab('operations')"
      id="operations">Operations</button>
  </div>
</div>
<main class="flex-1 overflow-y-auto p-6 custom-scrollbar">
  <!-- Notification Area for Success and Error Messages -->
  <div *ngIf="successMessage" class="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50">
    {{ successMessage }}
    <button (click)="clearMessage()" class="ml-2 text-white hover:text-gray-200">
      <i class="ri-close-line"></i>
    </button>
  </div>
  <div *ngIf="errorMessage" class="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50">
    {{ errorMessage }}
    <button (click)="clearMessage()" class="ml-2 text-white hover:text-gray-200">
      <i class="ri-close-line"></i>
    </button>
  </div>

  <!-- Fees Content-->
  <div id="tab-fees" class="tab-content">
    <!-- Fees Tabs -->
    <div class="bg-white rounded-lg shadow">
      <div class="border-b border-gray-200">
        <nav class="flex -mb-px">
          <button id="fees-overview" (click)="showTab('overview', 'fees')"
            class="fees-tab-button relative px-4 py-3 text-sm active font-medium text-primary">Fees Overview</button>
          <button id="fees-schema" (click)="showTab('schema', 'fees')"
            class="fees-tab-button relative px-4 py-3 text-sm text-gray-500">Fee Schemas</button>
          <button id="fees-type" (click)="showTab('type', 'fees')"
            class="fees-tab-button relative px-4 py-3 text-sm text-gray-500">Fee Types</button>
          <button id="fees-rule" (click)="showTab('rule', 'fees')"
            class="fees-tab-button relative px-4 py-3 text-sm text-gray-500">Fee Rules</button>
        </nav>
      </div>



      <!-- Fees Content -->
      <div id="fees-tab-overview" class="fees-tab-content p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-medium text-gray-900">Fees Management</h3>
          <button id="btn-add-status" (click)="toggleForm('fee')"
            class="flex items-center px-3 py-2 bg-primary text-white rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap">
            <i class="ri-add-line mr-1"></i> Add Fee
          </button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Fee Code</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Fee Identifier</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Fee Name</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Min</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Max</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Amount</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Percentage</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Max Amount</th>
                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let fee of feesList">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ fee.feeCode }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ fee.feeIden }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feeLabel }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feeMinLimit }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feeMaxLimit }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feeAmount }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feePercentage }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ fee.feeMaxAmount }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <div class="flex justify-end space-x-2">
                    <button class="text-green-600 hover:text-gray-500" (click)="editFee(fee)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-edit-line"></i>
                      </div>
                    </button>
                    <button class="text-red-600 hover:text-red-500" (click)="deleteFee(fee.feeCode)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-delete-bin-line"></i>
                      </div>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Fee Schema Content -->
      <div id="fees-tab-schema" class="fees-tab-content p-6 hidden">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-medium text-gray-900">Fee Schemas Management</h3>
          <button id="btn-add-status" (click)="toggleForm('fee-schema')"
            class="flex items-center px-3 py-2 bg-primary text-white rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap">
            <i class="ri-add-line mr-1"></i> Add Fee Schema </button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Schema Code
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Schema Identifier
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Schema Name
                </th>
                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let schema of feeSchemasList">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ schema.fscCode }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ schema.fscIden }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ schema.fscLabe }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <div class="flex justify-end space-x-2">
                    <button class="text-green-600 hover:text-gray-500" (click)="editFeeSchema(schema)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-edit-line"></i>
                      </div>
                    </button>
                    <button class="text-red-600 hover:text-red-500" (click)="deleteFeeSchema(schema.fscCode)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-delete-bin-line"></i>
                      </div>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Fee Rule Type Content -->
      <div id="fees-tab-type" class="fees-tab-content p-6 hidden">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-lg font-medium text-gray-900">Fee Rule Type Management</h3>
          <button id="btn-add-type" (click)="toggleForm('fee-rule-type')"
            class="flex items-center px-3 py-2 bg-primary text-white rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap">
            <i class="ri-add-line mr-1"></i> Add Fee Rule Type
          </button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Type Code
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Type Identifier
                </th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Type Name
                </th>
                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let type of feeRuleTypesList">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ type.frtCode }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ type.frtIden }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ type.frtLabe }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <div class="flex justify-end space-x-2">
                    <button class="text-green-600 hover:text-gray-500" (click)="editFeeRuleType(type)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-edit-line"></i>
                      </div>
                    </button>
                    <button class="text-red-600 hover:text-red-500" (click)="deleteFeeRuleType(type.frtCode)">
                      <div class="w-6 h-6 flex items-center justify-center">
                        <i class="ri-delete-bin-line"></i>
                      </div>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!-- Fee Rule Content -->
<div id="fees-tab-rule" class="fees-tab-content p-6 hidden">
  <div class="flex justify-between items-center mb-6">
    <h3 class="text-lg font-medium text-gray-900">Fee Rules Management</h3>
    <button id="btn-add-fee-rule" (click)="toggleForm('fee-rule')"
      class="flex items-center px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-opacity-90 transition whitespace-nowrap">
      <i class="ri-add-line mr-1"></i> Add Fee Rule
    </button>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rule Code</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rule Identifier</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rule Name</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Primary Amount</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fee Amount</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TVA</th>
          <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <tr *ngFor="let rule of feeRulesList">
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ rule.fruCode }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{{ rule.fruIden }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{{ rule.fruLabe }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{{ rule.fruPrimaryAmount }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{{ rule.fruFeesAmount }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{{ rule.fruTva.vatRate }}%</td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <div class="flex justify-end space-x-2">
              <button (click)="editFeeRule(rule)" class="text-green-600 hover:text-green-400">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-edit-line"></i>
                </div>
              </button>
              <button (click)="deleteFeeRule(rule.fruCode)" class="text-red-600 hover:text-red-400">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-delete-bin-line"></i>
                </div>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
    </div>
  </div>

  <!-- Operations Content -->
  <div id="tab-operations" class="tab-content hidden">
    <!-- Operations Tabs -->
    <div class="bg-white rounded-lg shadow">
      <div class="border-b border-gray-200">
        <nav class="flex -mb-px">
          <button id="operations-type" (click)="showTab('type', 'operations')"
            class="operations-tab-button relative px-4 py-3 text-sm active font-medium text-primary">Operation
            Types</button>
          <button id="operations-mapping" (click)="showTab('mapping', 'operations')"
            class="operations-tab-button relative px-4 py-3 text-sm text-gray-500">Operations Mapping</button>
          <button id="operations-periodicity" (click)="showTab('periodicity', 'operations')"
            class="operations-tab-button relative px-4 py-3 text-sm text-gray-500">Periodicity</button>
        </nav>
      </div>

    <!-- Operation type Content -->
<div id="operations-tab-type" class="operations-tab-content p-6">
  <div class="flex justify-between items-center mb-6">
    <h3 class="text-lg font-medium text-gray-900">Operation Type Management</h3>
    <button id="btn-add-status" (click)="toggleForm('operation-type')"
      class="flex items-center px-3 py-2 bg-primary text-white rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap">
      <i class="ri-add-line mr-1"></i> Add Operation Type
    </button>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Type Code
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Type Identifier
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Type Name
          </th>
          <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <tr *ngFor="let operationType of operationTypesList">
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ operationType.optCode }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ operationType.optIden }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ operationType.optLabe }}</td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <div class="flex justify-end space-x-2">
              <button (click)="editOperationType(operationType)" class="text-green-600 hover:text-gray-500">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-edit-line"></i>
                </div>
              </button>
              <button (click)="deleteOperationType(operationType.optCode)" class="text-red-600 hover:text-red-500">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-delete-bin-line"></i>
                </div>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
      <!-- Periodicity Content -->
<div id="operations-tab-periodicity" class="operations-tab-content p-6 hidden">
  <div class="flex justify-between items-center mb-6">
    <h3 class="text-lg font-medium text-gray-900">Periodicity Management</h3>
    <button id="btn-add-periodicity" (click)="toggleForm('operation-periodicity')"
      class="flex items-center px-4 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-opacity-90 transition whitespace-nowrap">
      <i class="ri-add-line mr-1"></i> Add Periodicity
    </button>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Code
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Identifier
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Label
          </th>
          <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <tr *ngFor="let periodicity of periodicitiesList">
          <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ periodicity.perCode }}</td>
          <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">{{ periodicity.perIden }}</td>
          <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">{{ periodicity.perLabe }}</td>
          <td class="px-4 py-4 whitespace-nowrap text-right text-sm font-medium">
            <div class="flex justify-end space-x-2">
              <button (click)="editPeriodicity(periodicity)" class="text-green-600 hover:text-green-400">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-edit-line"></i>
                </div>
              </button>
              <button (click)="deletePeriodicity(periodicity.perCode)" class="text-red-600 hover:text-red-400">
                <div class="w-6 h-6 flex items-center justify-center">
                  <i class="ri-delete-bin-line"></i>
                </div>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
  </div>


<!-- FORMS -->
<div *ngIf="isAnyModalVisible" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <!-- Add/Edit Fee Modal (already included above, removing duplicate) -->
  <!-- Add/Edit Fee Modal -->
  <div *ngIf="isFeeVisible" id="add-fee-modal" class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">{{ selectedFee ? 'Edit Fee' : 'Add Fee' }}</h3>
      <button id="close-type-modal" (click)="closeForm('fee')" class="text-gray-400 hover:text-gray-500">
        <div class="w-6 h-6 flex items-center justify-center">
          <i class="ri-close-line"></i>
        </div>
      </button>
    </div>
    <form id="add-type-form" class="p-6" (ngSubmit)="selectedFee ? updateFee() : addFee()" #feeForm="ngForm">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="feeIden" class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
          <input type="text" id="feeIden" name="feeIden" [(ngModel)]="newFee.feeIden"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Identifier" required>
        </div>
        <div>
          <label for="feeLabel" class="block text-sm font-medium text-gray-700 mb-1">Fee Label</label>
          <input type="text" id="feeLabel" name="feeLabel" [(ngModel)]="newFee.feeLabel"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Label" required>
        </div>
        <div>
          <label for="feeMinLimit" class="block text-sm font-medium text-gray-700 mb-1">Min</label>
          <input type="number" id="feeMinLimit" name="feeMinLimit" [(ngModel)]="newFee.feeMinLimit"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Minimum amount" required min="0">
        </div>
        <div>
          <label for="feeMaxLimit" class="block text-sm font-medium text-gray-700 mb-1">Max</label>
          <input type="number" id="feeMaxLimit" name="feeMaxLimit" [(ngModel)]="newFee.feeMaxLimit"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Maximum Amount" required min="0">
        </div>
        <div>
          <label for="feeAmount" class="block text-sm font-medium text-gray-700 mb-1">Fee Amount</label>
          <input type="number" id="feeAmount" name="feeAmount" [(ngModel)]="newFee.feeAmount"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Amount" required min="0">
        </div>
        <div>
          <label for="feePercentage" class="block text-sm font-medium text-gray-700 mb-1">Percentage</label>
          <input type="text" id="feePercentage" name="feePercentage" [(ngModel)]="newFee.feePercentage"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Percentage" required>
        </div>
        <div>
          <label for="feeMaxAmount" class="block text-sm font-medium text-gray-700 mb-1">Max Fee Amount</label>
          <input type="number" id="feeMaxAmount" name="feeMaxAmount" [(ngModel)]="newFee.feeMaxAmount"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Maximum fee amount" required min="0">
        </div>
        <div>
          <label for="financialInstitutionId" class="block text-sm font-medium text-gray-700 mb-1">Financial Institution
            ID</label>
          <input type="number" id="financialInstitutionId" name="financialInstitutionId"
            [(ngModel)]="newFee.financialInstitutionId"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
            placeholder="Financial Institution ID" required min="1">
        </div>
      </div>
      <div class="mt-6 flex justify-end space-x-3">
        <button type="button" (click)="closeForm('fee')" id="cancel-add-type"
          class="px-4 py-2 border border-gray-300 rounded-button text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">Cancel</button>
        <button type="submit" [disabled]="feeForm.invalid"
          class="px-4 py-2 bg-primary text-white rounded-button hover:bg-red-700 whitespace-nowrap">
          {{ selectedFee ? 'Update Fee' : 'Add Fee' }}
        </button>
      </div>
    </form>
  </div>
  <!-- Add/Edit Fee Schema Modal -->
  <div *ngIf="isFeeSchemaVisible" id="fee-schema-modal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h3 class="text-lg font-medium text-gray-900">{{ selectedFeeSchema ? 'Edit Fee Schema' : 'Add Fee Schema' }}
        </h3>
        <button id="close-type-modal" (click)="closeForm('fee-schema')" class="text-gray-400 hover:text-gray-500">
          <div class="w-6 h-6 flex items-center justify-center">
            <i class="ri-close-line"></i>
          </div>
        </button>
      </div>
      <div class="p-6">
        <form id="fee-schema-form" (ngSubmit)="selectedFeeSchema ? updateFeeSchema() : addFeeSchema()">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
              <input type="text" id="fscIden" name="fscIden" [(ngModel)]="newFeeSchema.fscIden"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
                placeholder="Identifier" required>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Schema Label</label>
              <input type="text" id="fscLabe" name="fscLabe" [(ngModel)]="newFeeSchema.fscLabe"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
                placeholder="Label" required>
            </div>
          </div>
          <div class="mt-6 flex justify-end space-x-3">
            <button type="button" (click)="closeForm('fee-schema')" id="cancel-fee-schema"
              class="px-4 py-2 border border-gray-300 rounded-button text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">
              Cancel
            </button>
            <button type="submit"
              class="px-4 py-2 bg-primary text-white rounded-button hover:bg-red-700 whitespace-nowrap">
              {{ selectedFeeSchema ? 'Update Schema' : 'Add Schema' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add/Edit Operation Type Modal -->
<div *ngIf="isOperationTypeVisible" id="add-type-modal"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">{{ selectedOperationType ? 'Edit Operation Type' : 'Add Operation Type' }}</h3>
      <button id="close-type-modal" (click)="closeForm('operation-type')" class="text-gray-400 hover:text-gray-500">
        <div class="w-6 h-6 flex items-center justify-center">
          <i class="ri-close-line"></i>
        </div>
      </button>
    </div>
    <div class="p-6">
      <form id="operation-type-form" (ngSubmit)="selectedOperationType ? updateOperationType() : addOperationType()">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
            <input type="text" id="optIden" name="optIden" [(ngModel)]="newOperationType.optIden"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Identifier" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Operation Type Label</label>
            <input type="text" id="optLabe" name="optLabe" [(ngModel)]="newOperationType.optLabe"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Label" required>
          </div>
        </div>
        <div class="mt-6 flex justify-end space-x-3">
          <button type="button" (click)="closeForm('operation-type')" id="cancel-add-type"
            class="px-4 py-2 border border-gray-300 rounded-button text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">
            Cancel
          </button>
          <button type="submit"
            class="px-4 py-2 bg-primary text-white rounded-button hover:bg-red-700 whitespace-nowrap">
            {{ selectedOperationType ? 'Update Type' : 'Add Type' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
  <!-- Add/Edit Fee Rule Modal -->
<div *ngIf="isFeeRuleVisible" id="fee-rule-modal"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">{{ selectedFeeRule ? 'Edit Fee Rule' : 'Add Fee Rule' }}</h3>
      <button id="close-fee-rule-modal" (click)="closeForm('fee-rule')" class="text-gray-400 hover:text-gray-500">
        <div class="w-6 h-6 flex items-center justify-center">
          <i class="ri-close-line"></i>
        </div>
      </button>
    </div>
    <div class="p-6">
      <form id="fee-rule-form" (ngSubmit)="selectedFeeRule ? updateFeeRule() : addFeeRule()" #feeRuleForm="ngForm">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="fruIden" class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
            <input type="text" id="fruIden" name="fruIden" [(ngModel)]="newFeeRule.fruIden"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruIden="ngModel">
            <div *ngIf="fruIden.invalid && fruIden.touched" class="text-red-500 text-sm">Identifier is required.</div>
          </div>
          <div>
            <label for="fruLabe" class="block text-sm font-medium text-gray-700 mb-1">Label</label>
            <input type="text" id="fruLabe" name="fruLabe" [(ngModel)]="newFeeRule.fruLabe"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruLabe="ngModel">
            <div *ngIf="fruLabe.invalid && fruLabe.touched" class="text-red-500 text-sm">Label is required.</div>
          </div>
          <div>
            <label for="fruPrimaryWalletId" class="block text-sm font-medium text-gray-700 mb-1">Primary Wallet</label>
            <select id="fruPrimaryWalletId" name="fruPrimaryWalletId" [(ngModel)]="newFeeRule.fruPrimaryWalletId"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruPrimaryWalletId="ngModel">
              <option value="">Select Wallet</option>
              <option *ngFor="let wallet of wallets" [value]="wallet.id">{{ wallet.label }}</option>
            </select>
            <div *ngIf="fruPrimaryWalletId.invalid && fruPrimaryWalletId.touched" class="text-red-500 text-sm">Primary Wallet is required.</div>
          </div>
          <div>
            <label for="fruPrimaryAmount" class="block text-sm font-medium text-gray-700 mb-1">Primary Amount</label>
            <input type="number" id="fruPrimaryAmount" name="fruPrimaryAmount" [(ngModel)]="newFeeRule.fruPrimaryAmount"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruPrimaryAmount="ngModel">
            <div *ngIf="fruPrimaryAmount.invalid && fruPrimaryAmount.touched" class="text-red-500 text-sm">Primary Amount is required.</div>
          </div>
          <div>
            <label for="fruPrimaryFeesId" class="block text-sm font-medium text-gray-700 mb-1">Primary Fees ID</label>
            <input type="number" id="fruPrimaryFeesId" name="fruPrimaryFeesId" [(ngModel)]="newFeeRule.fruPrimaryFeesId"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruPrimaryFeesId="ngModel">
            <div *ngIf="fruPrimaryFeesId.invalid && fruPrimaryFeesId.touched" class="text-red-500 text-sm">Primary Fees ID is required.</div>
          </div>
          <div>
            <label for="fruFeesWalletId" class="block text-sm font-medium text-gray-700 mb-1">Fees Wallet</label>
            <select id="fruFeesWalletId" name="fruFeesWalletId" [(ngModel)]="newFeeRule.fruFeesWalletId"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruFeesWalletId="ngModel">
              <option value="">Select Wallet</option>
              <option *ngFor="let wallet of wallets" [value]="wallet.id">{{ wallet.label }}</option>
            </select>
            <div *ngIf="fruFeesWalletId.invalid && fruFeesWalletId.touched" class="text-red-500 text-sm">Fees Wallet is required.</div>
          </div>
          <div>
            <label for="fruFeesAmount" class="block text-sm font-medium text-gray-700 mb-1">Fees Amount</label>
            <input type="number" id="fruFeesAmount" name="fruFeesAmount" [(ngModel)]="newFeeRule.fruFeesAmount"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruFeesAmount="ngModel">
            <div *ngIf="fruFeesAmount.invalid && fruFeesAmount.touched" class="text-red-500 text-sm">Fees Amount is required.</div>
          </div>
          <div>
            <label for="fruTva" class="block text-sm font-medium text-gray-700 mb-1">TVA Rate</label>
            <select id="fruTva" name="fruTva" [(ngModel)]="newFeeRule.fruTva.vatCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruTva="ngModel">
              <option value="">Select TVA Rate</option>
              <option *ngFor="let vat of vatRatesList" [value]="vat.vatCode">{{ vat.vatRate }}% - {{ vat.vatLabe }}</option>
            </select>
            <div *ngIf="fruTva.invalid && fruTva.touched" class="text-red-500 text-sm">TVA Rate is required.</div>
          </div>
          <div>
            <label for="fruTvaWalletId" class="block text-sm font-medium text-gray-700 mb-1">TVA Wallet</label>
            <select id="fruTvaWalletId" name="fruTvaWalletId" [(ngModel)]="newFeeRule.fruTvaWalletId"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruTvaWalletId="ngModel">
              <option value="">Select Wallet</option>
              <option *ngFor="let wallet of wallets" [value]="wallet.id">{{ wallet.label }}</option>
            </select>
            <div *ngIf="fruTvaWalletId.invalid && fruTvaWalletId.touched" class="text-red-500 text-sm">TVA Wallet is required.</div>
          </div>
          <div>
            <label for="fruTvaAmount" class="block text-sm font-medium text-gray-700 mb-1">TVA Amount</label>
            <input type="number" id="fruTvaAmount" name="fruTvaAmount" [(ngModel)]="newFeeRule.fruTvaAmount"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruTvaAmount="ngModel">
            <div *ngIf="fruTvaAmount.invalid && fruTvaAmount.touched" class="text-red-500 text-sm">TVA Amount is required.</div>
          </div>
          <div>
            <label for="fruSens" class="block text-sm font-medium text-gray-700 mb-1">Sense</label>
            <select id="fruSens" name="fruSens" [(ngModel)]="newFeeRule.fruSens"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #fruSens="ngModel">
              <option value="">Select Sense</option>
              <option value="DEBIT">Debit</option>
              <option value="CREDIT">Credit</option>
            </select>
            <div *ngIf="fruSens.invalid && fruSens.touched" class="text-red-500 text-sm">Sense is required.</div>
          </div>
          <div>
            <label for="feeRuleType" class="block text-sm font-medium text-gray-700 mb-1">Fee Rule Type</label>
            <select id="feeRuleType" name="feeRuleType" [(ngModel)]="newFeeRule.feeRuleType.frtCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #feeRuleType="ngModel">
              <option value="">Select Fee Rule Type</option>
              <option *ngFor="let type of feeRuleTypesList" [value]="type.frtCode">{{ type.frtLabe }}</option>
            </select>
            <div *ngIf="feeRuleType.invalid && feeRuleType.touched" class="text-red-500 text-sm">Fee Rule Type is required.</div>
          </div>
          <div>
            <label for="feeSchema" class="block text-sm font-medium text-gray-700 mb-1">Fee Schema</label>
            <select id="feeSchema" name="feeSchema" [(ngModel)]="newFeeRule.feeSchema.fscCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg" required #feeSchema="ngModel">
              <option value="">Select Fee Schema</option>
              <option *ngFor="let schema of feeSchemasList" [value]="schema.fscCode">{{ schema.fscLabe }}</option>
            </select>
            <div *ngIf="feeSchema.invalid && feeSchema.touched" class="text-red-500 text-sm">Fee Schema is required.</div>
          </div>
        </div>
        <div class="mt-6 flex justify-end space-x-3">
          <button type="button" (click)="closeForm('fee-rule')" id="cancel-add-fee-rule"
            class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">
            Cancel
          </button>
          <button type="submit" [disabled]="feeRuleForm.invalid"
            class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition whitespace-nowrap"
            [ngClass]="{'opacity-50 cursor-not-allowed': feeRuleForm.invalid}">
            {{ selectedFeeRule ? 'Update Fee Rule' : 'Add Fee Rule' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Add/Edit Operation Type Modal -->
<div *ngIf="isOperationTypeVisible" id="add-type-modal"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">{{ selectedOperationType ? 'Edit Operation Type' : 'Add Operation Type' }}</h3>
      <button id="close-type-modal" (click)="closeForm('operation-type')" class="text-gray-400 hover:text-gray-500">
        <div class="w-6 h-6 flex items-center justify-center">
          <i class="ri-close-line"></i>
        </div>
      </button>
    </div>
    <div class="p-6">
      <form id="operation-type-form" (ngSubmit)="selectedOperationType ? updateOperationType() : addOperationType()">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
            <input type="text" id="optIden" name="optIden" [(ngModel)]="newOperationType.optIden"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Identifier" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Operation Type Label</label>
            <input type="text" id="optLabe" name="optLabe" [(ngModel)]="newOperationType.optLabe"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Label" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Fee Schema Identifier</label>
            <input type="number" id="optFscIden" name="optFscIden" [(ngModel)]="newOperationType.optFscIden"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Fee Schema Identifier" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Fee Schema Label</label>
            <input type="text" id="optFscLab" name="optFscLab" [(ngModel)]="newOperationType.optFscLab"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              placeholder="Fee Schema Label" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Fee Schema</label>
            <select id="feeSchema" name="feeSchema" [(ngModel)]="newOperationType.feeSchema.fscCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
              required>
              <option value="" disabled selected>Select Fee Schema</option>
              <option *ngFor="let schema of feeSchemasList" [value]="schema.fscCode">
                {{ schema.fscLabe }}
              </option>
            </select>
          </div>
        </div>
        <div class="mt-6 flex justify-end space-x-3">
          <button type="button" (click)="closeForm('operation-type')" id="cancel-add-type"
            class="px-4 py-2 border border-gray-300 rounded-button text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">
            Cancel
          </button>
          <button type="submit"
            class="px-4 py-2 bg-primary text-white rounded-button hover:bg-red-700 whitespace-nowrap">
            {{ selectedOperationType ? 'Update Type' : 'Add Type' }}
          </button>
        </div>
      </form>
    </div>
   </div>
  </div>


    <!-- Add/Edit Periodicity Modal -->
  <div *ngIf="isPeriodicityVisible" id="add-periodicity-modal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h3 class="text-lg font-medium text-gray-900">{{ selectedPeriodicity ? 'Edit Periodicity' : 'Add Periodicity' }}</h3>
        <button id="close-periodicity-modal" (click)="closeForm('operation-periodicity')"
          class="text-gray-400 hover:text-gray-500">
          <div class="w-6 h-6 flex items-center justify-center">
            <i class="ri-close-line"></i>
          </div>
        </button>
      </div>
      <div class="p-6">
        <form id="periodicity-form" (ngSubmit)="selectedPeriodicity ? updatePeriodicity() : addPeriodicity()">
          <div class="space-y-4">
            <div>
              <label for="perIden" class="block text-sm font-medium text-gray-700 mb-1">Identifier</label>
              <input type="text" id="perIden" name="perIden" [(ngModel)]="newPeriodicity.perIden"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
                placeholder="Identifier" required>
            </div>
            <div>
              <label for="perLabe" class="block text-sm font-medium text-gray-700 mb-1">Periodicity Label</label>
              <input type="text" id="perLabe" name="perLabe" [(ngModel)]="newPeriodicity.perLabe"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary"
                placeholder="Label" required>
            </div>
          </div>
          <div class="mt-6 flex justify-end space-x-3">
            <button type="button" (click)="closeForm('operation-periodicity')" id="cancel-add-periodicity"
              class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 bg-white hover:bg-gray-50 whitespace-nowrap">
              Cancel
            </button>
            <button type="submit"
              class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition whitespace-nowrap">
              {{ selectedPeriodicity ? 'Update Periodicity' : 'Add Periodicity' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>